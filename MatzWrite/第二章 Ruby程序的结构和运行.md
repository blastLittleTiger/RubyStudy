本章解释了Ruby程序的结构. 首先讲解词法结构,涵盖标记(token)及组成它们的字符,接下来,讲解Ruby程序的句法结构,阐明一串标记是如何构成表达式,控制结构,类及方法之类的结构的;最后,本章描述Ruby的代码文件,解释Ruby程序是如何再多个代码文件之间进行分布的,以及Ruby解释其是如何执行一个Ruby代码文件的.

### 2.1 词法结构
Ruby解释器会把一个程序解析为一个标记序列,标记包括注释,字面量,标点符号,标识符及关键字.本节介绍标记,以及组成这些标记的字符和分割这些标记的空白符.

#### 注释
以`#`开头
##### 嵌入式文档
`=begin`开头, `=end`结尾
##### 文档化的注释
`=begin rdoc`

#### 字面量
直接出现再Ruby源代码里的值.包括数字,文本字符串以及正则表达式.

    1
    1.0
    'one'
    'two'
    /three/

#### 标点符号

#### 标识符
一个标识符就是一个名字.由数字,字母和下划线字符组成.但是不能以数字开头.
A到Z开头的标识符是常量.类和模块名必须以大写字母开头.

    i
    x2
    old_value
    _internal
    PI

惯例: 非常量的多字节标识符以下划线分割多个字节,比如`like_this`; 多字节常量则以`LikeThis`或者`LIKE_THIS`的形式表示.

##### 大小写敏感
##### 标识符中的Unicode字符
##### 标识符里的标点符号

  $ 沿袭Perl的做法,Ruby也定义了一些包含其他标点符号的全局变量,比如$_and $K.
  @ 实例变量以一个@开头,而类变量是两个@符号开头.
  ? 一个有用的惯例,返回布尔值的方法通常都有一个以问号结尾的名字.
  ! 感叹号结尾,使用时要小心.
  = 等号结尾,那么再调用此方法时可以省略此等号.这种方法通常被至于复制操作符的左侧.

#### 关键字

    _LINE_      case        ensure  note    then
    _ENCODING_  class       false   or      true
    _FILE_      def         for     redo    undef
    BEGIN       defined?    if      rescue  unless
    END         do          in      retry   until
    alias       else        module  return  when
    and         elsif       next    self    while
    begin       end         nil     super   yield
    break

除了上述关键字,还有`=begin`,`=end`,`_END_`

Ruby语言的许多重要特性实际上是用Kernel,Module,Class及Object这几个类的方法来实现的.

#### 空白符
有时候插入或删除空白符将导致程序的语义发生变化.

##### 作为语句终结符的换行符

        total = x+
        y   #这段是将x和y的和赋给total

        total = x
        +y  #这段是将x赋值给total,然后对y求值

Ruby 1.9 中,如果一行代码的第一个非空白的字符是一个句点,那么这一行将被当成是上一行的延续.

        animals = Array.new
            .push("dog")
            .push("cow")
            .push("cat")
            .sort

##### 空格符与方法调用
空白符依赖性,比如`f(3+2)+1`和`f (3+2)+1`是不同的.对于这种空白符依赖性问题的解决办法很直接:

* 永远不要再方法名和其后的左圆括号之间之间留白
* 如果一个方法的第一个参数以圆括号开头,那么再此方法的调用中,请一直使用圆括号,比如`f((3+2)+1)`;
* 请一直使用Ruby解释器的`-w`选项,这样它就会在你忘记了上述规则时发出警告.

### 2.2 句法结构
Ruby中最基本的句法单元是表达式.最简单的表达式就是初级表达式(primary expressions). 他们直接代表值,数字和字符串字面量就是初级表达式,其他的初级表达式包括特定的关键字,比如true,false,nil及self.对变量的引用也是初级表达式,对它们求值的结果就是其指向的变量的值.



